{"dependencies":[{"name":"react-native","isAsync":false},{"name":"react-native-router-flux","isAsync":false},{"name":"react-native-fcm","isAsync":false},{"name":"./UserData","isAsync":false}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.registerKilledListener = registerKilledListener;\n  exports.registerAppListener = registerAppListener;\n\n  var _reactNative = _$$_REQUIRE(_dependencyMap[0], \"react-native\");\n\n  var _reactNativeRouterFlux = _$$_REQUIRE(_dependencyMap[1], \"react-native-router-flux\");\n\n  var _reactNativeFcm = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[2], \"react-native-fcm\"));\n\n  var _UserData = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./UserData\"));\n\n  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\n  _reactNative.AsyncStorage.getItem('lastNotification').then(function (data) {\n    if (data) {\n      console.log('last notification', JSON.parse(data));\n\n      _reactNative.AsyncStorage.removeItem('lastNotification');\n    }\n  });\n\n  _reactNative.AsyncStorage.getItem('lastMessage').then(function (data) {\n    if (data) {\n      console.log('last message', JSON.parse(data));\n\n      _reactNative.AsyncStorage.removeItem('lastMessage');\n    }\n  });\n\n  function registerKilledListener() {\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.Notification, function (notif) {\n      _reactNative.AsyncStorage.setItem('lastNotification', JSON.stringify(notif));\n\n      if (notif.opened_from_tray) {\n        setTimeout(function () {\n          if (notif._actionIdentifier === 'reply') {\n            if (_reactNative.AppState.currentState !== 'background') {\n              console.log('User replied ' + JSON.stringify(notif._userText));\n              alert('User replied ' + JSON.stringify(notif._userText));\n            } else {\n              _reactNative.AsyncStorage.setItem('lastMessage', JSON.stringify(notif._userText));\n            }\n          }\n\n          if (notif._actionIdentifier === 'view') {\n            alert(\"User clicked View in App\");\n          }\n\n          if (notif._actionIdentifier === 'dismiss') {\n            alert(\"User clicked Dismiss\");\n          }\n        }, 1000);\n      }\n    });\n  }\n\n  function registerAppListener(navigation) {\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.Notification, function (notif) {\n      console.log(\"Notification\", notif);\n\n      if (_reactNative.Platform.OS === 'ios' && notif._notificationType === _reactNativeFcm.NotificationType.WillPresent && !notif.local_notification) {\n        notif.finish(_reactNativeFcm.WillPresentNotificationResult.All);\n        return;\n      }\n\n      if (notif.opened_from_tray) {\n        if (notif.targetScreen === 'detail') {\n          setTimeout(function () {\n            navigation.navigate('Detail');\n          }, 500);\n        }\n\n        setTimeout(function () {\n          _UserData.default.retriveData('token').then(function (res) {\n            console.log(res);\n\n            if (res === '') {\n              _reactNativeRouterFlux.Actions.Login();\n            } else {\n              _reactNativeRouterFlux.Actions.Notification();\n            }\n          }, function (err) {\n            console.log(err);\n          });\n        }, 100);\n      }\n\n      if (_reactNative.Platform.OS === 'ios') {\n        switch (notif._notificationType) {\n          case _reactNativeFcm.NotificationType.Remote:\n            notif.finish(_reactNativeFcm.RemoteNotificationResult.NewData);\n            break;\n\n          case _reactNativeFcm.NotificationType.NotificationResponse:\n            notif.finish();\n            break;\n\n          case _reactNativeFcm.NotificationType.WillPresent:\n            notif.finish(_reactNativeFcm.WillPresentNotificationResult.All);\n            break;\n        }\n      }\n    });\n\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.RefreshToken, function (token) {\n      console.log(\"TOKEN (refreshUnsubscribe)\", token);\n    });\n\n    _reactNativeFcm.default.enableDirectChannel();\n\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.DirectChannelConnectionChanged, function (data) {\n      console.log('direct channel connected' + data);\n    });\n\n    setTimeout(function () {\n      _reactNativeFcm.default.isDirectChannelEstablished().then(function (d) {\n        return console.log(d);\n      });\n    }, 1000);\n  }\n\n  _reactNativeFcm.default.setNotificationCategories([{\n    id: 'com.thg.test',\n    actions: [{\n      type: _reactNativeFcm.NotificationActionType.TextInput,\n      id: 'reply',\n      title: 'Quick Reply',\n      textInputButtonTitle: 'Send',\n      textInputPlaceholder: 'Say something',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.AuthenticationRequired\n    }, {\n      type: _reactNativeFcm.NotificationActionType.Default,\n      id: 'view',\n      title: 'View in App',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.Foreground\n    }, {\n      type: _reactNativeFcm.NotificationActionType.Default,\n      id: 'dismiss',\n      title: 'Dismiss',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.Destructive\n    }],\n    options: [_reactNativeFcm.NotificationCategoryOption.CustomDismissAction, _reactNativeFcm.NotificationCategoryOption.PreviewsShowTitle]\n  }]);\n});","map":[[8,0,5,0],[10,0,6,0],[12,0,7,0],[14,0,8,0],[20,0,11,0,"AsyncStorage"],[20,28,11,13,"getItem"],[20,35,11,0],[20,36,11,21],[20,54,11,0],[20,56,11,41,"then"],[20,60,11,0],[20,61,11,46],[20,77,11,54],[21,0,12,4],[21,8,12,8,"data"],[21,12,12,4],[21,14,12,14],[22,0,14,8,"console"],[22,14,14,16,"log"],[22,17,14,8],[22,18,14,20],[22,37,14,8],[22,39,14,41,"JSON"],[22,44,14,46,"parse"],[22,49,14,41],[22,50,14,52,"data"],[22,54,14,41],[22,55,14,8],[24,0,15,8,"AsyncStorage"],[24,32,15,21,"removeItem"],[24,42,15,8],[24,43,15,32],[24,61,15,8],[25,0,16,5],[26,0,17,1],[26,3,11,0],[28,0,19,0,"AsyncStorage"],[28,28,19,13,"getItem"],[28,35,19,0],[28,36,19,21],[28,49,19,0],[28,51,19,36,"then"],[28,55,19,0],[28,56,19,41],[28,72,19,49],[29,0,20,4],[29,8,20,8,"data"],[29,12,20,4],[29,14,20,14],[30,0,22,8,"console"],[30,14,22,16,"log"],[30,17,22,8],[30,18,22,20],[30,32,22,8],[30,34,22,36,"JSON"],[30,39,22,41,"parse"],[30,44,22,36],[30,45,22,47,"data"],[30,49,22,36],[30,50,22,8],[32,0,23,8,"AsyncStorage"],[32,32,23,21,"removeItem"],[32,42,23,8],[32,43,23,32],[32,56,23,8],[33,0,24,5],[34,0,25,1],[34,3,19,0],[36,0,27,7],[36,11,27,16,"registerKilledListener"],[36,33,27,7],[36,36,27,41],[37,0,29,4,"FCM"],[37,28,29,8,"on"],[37,30,29,4],[37,31,29,11,"FCMEvent"],[37,56,29,20,"Notification"],[37,68,29,4],[37,70,29,34],[37,87,29,43],[38,0,30,8,"AsyncStorage"],[38,32,30,21,"setItem"],[38,39,30,8],[38,40,30,29],[38,58,30,8],[38,60,30,49,"JSON"],[38,65,30,54,"stringify"],[38,74,30,49],[38,75,30,64,"notif"],[38,80,30,49],[38,81,30,8],[40,0,31,8],[40,10,31,12,"notif"],[40,16,31,18,"opened_from_tray"],[40,32,31,8],[40,34,31,36],[41,0,32,12,"setTimeout"],[41,19,32,23],[41,31,32,29],[42,0,33,16],[42,14,33,20,"notif"],[42,20,33,26,"_actionIdentifier"],[42,37,33,20],[42,42,33,48],[42,49,33,16],[42,51,33,57],[43,0,34,20],[43,16,34,24,"AppState"],[43,38,34,33,"currentState"],[43,50,34,24],[43,55,34,50],[43,67,34,20],[43,69,34,64],[44,0,35,24,"console"],[44,22,35,32,"log"],[44,25,35,24],[44,26,35,36],[44,44,35,54,"JSON"],[44,49,35,59,"stringify"],[44,58,35,54],[44,59,35,69,"notif"],[44,65,35,75,"_userText"],[44,74,35,54],[44,75,35,24],[45,0,36,24,"alert"],[45,20,36,30],[45,38,36,48,"JSON"],[45,43,36,53,"stringify"],[45,52,36,48],[45,53,36,63,"notif"],[45,59,36,69,"_userText"],[45,68,36,48],[45,69,36,24],[46,0,37,21],[46,13,34,20],[46,19,37,27],[47,0,38,24,"AsyncStorage"],[47,40,38,37,"setItem"],[47,47,38,24],[47,48,38,45],[47,61,38,24],[47,63,38,60,"JSON"],[47,68,38,65,"stringify"],[47,77,38,60],[47,78,38,75,"notif"],[47,84,38,81,"_userText"],[47,93,38,60],[47,94,38,24],[48,0,39,21],[49,0,40,17],[51,0,41,16],[51,14,41,20,"notif"],[51,20,41,26,"_actionIdentifier"],[51,37,41,20],[51,42,41,48],[51,48,41,16],[51,50,41,56],[52,0,42,20,"alert"],[52,18,42,26],[52,44,42,20],[53,0,43,17],[55,0,44,16],[55,14,44,20,"notif"],[55,20,44,26,"_actionIdentifier"],[55,37,44,20],[55,42,44,48],[55,51,44,16],[55,53,44,59],[56,0,45,20,"alert"],[56,18,45,26],[56,40,45,20],[57,0,46,17],[58,0,47,13],[58,9,32,12],[58,11,47,15],[58,15,32,12],[59,0,48,9],[60,0,49,5],[60,5,29,4],[61,0,50,1],[63,0,53,7],[63,11,53,16,"registerAppListener"],[63,30,53,7],[63,31,53,36,"navigation"],[63,41,53,7],[63,43,53,48],[64,0,54,4,"FCM"],[64,28,54,8,"on"],[64,30,54,4],[64,31,54,11,"FCMEvent"],[64,56,54,20,"Notification"],[64,68,54,4],[64,70,54,34],[64,87,54,43],[65,0,55,8,"console"],[65,14,55,16,"log"],[65,17,55,8],[65,18,55,20],[65,32,55,8],[65,34,55,36,"notif"],[65,39,55,8],[67,0,57,8],[67,10,57,12,"Platform"],[67,32,57,21,"OS"],[67,34,57,12],[67,39,57,28],[67,44,57,12],[67,48,57,37,"notif"],[67,54,57,43,"_notificationType"],[67,71,57,37],[67,76,57,65,"NotificationType"],[67,109,57,82,"WillPresent"],[67,120,57,12],[67,124,57,97],[67,125,57,98,"notif"],[67,131,57,104,"local_notification"],[67,149,57,8],[67,151,57,124],[68,0,60,12,"notif"],[68,14,60,18,"finish"],[68,20,60,12],[68,21,60,25,"WillPresentNotificationResult"],[68,67,60,55,"All"],[68,70,60,12],[69,0,61,12],[70,0,62,9],[72,0,64,8],[72,10,64,12,"notif"],[72,16,64,18,"opened_from_tray"],[72,32,64,8],[72,34,64,36],[73,0,65,12],[73,12,65,16,"notif"],[73,18,65,22,"targetScreen"],[73,30,65,16],[73,35,65,39],[73,43,65,12],[73,45,65,49],[74,0,66,16,"setTimeout"],[74,21,66,27],[74,33,66,33],[75,0,67,20,"navigation"],[75,23,67,31,"navigate"],[75,31,67,20],[75,32,67,40],[75,40,67,20],[76,0,68,17],[76,11,66,16],[76,13,68,19],[76,16,66,16],[77,0,69,13],[79,0,70,12,"setTimeout"],[79,19,70,23],[79,31,70,29],[80,0,73,16,"UserData"],[80,28,73,25,"retriveData"],[80,39,73,16],[80,40,73,37],[80,47,73,16],[80,49,73,46,"then"],[80,53,73,16],[80,54,73,51],[80,64,73,52,"res"],[80,67,73,51],[80,69,73,60],[81,0,74,20,"console"],[81,20,74,28,"log"],[81,23,74,20],[81,24,74,32,"res"],[81,27,74,20],[83,0,75,20],[83,16,75,24,"res"],[83,24,75,32],[83,26,75,20],[83,28,75,36],[84,0,76,24,"Actions"],[84,45,76,32,"Login"],[84,50,76,24],[85,0,77,21],[85,13,75,20],[85,19,77,27],[86,0,79,24,"Actions"],[86,45,79,32,"Notification"],[86,57,79,24],[87,0,81,21],[88,0,82,17],[88,11,73,16],[88,13,82,19],[88,23,82,20,"err"],[88,26,82,19],[88,28,82,28],[89,0,83,20,"console"],[89,20,83,28,"log"],[89,23,83,20],[89,24,83,32,"err"],[89,27,83,20],[90,0,84,17],[90,11,73,16],[91,0,86,13],[91,9,70,12],[91,11,86,15],[91,14,70,12],[92,0,87,9],[94,0,89,8],[94,10,89,12,"Platform"],[94,32,89,21,"OS"],[94,34,89,12],[94,39,89,28],[94,44,89,8],[94,46,89,35],[95,0,94,12],[95,16,94,20,"notif"],[95,22,94,26,"_notificationType"],[95,39,94,12],[96,0,95,16],[96,15,95,21,"NotificationType"],[96,48,95,38,"Remote"],[96,54,95,16],[97,0,96,20,"notif"],[97,18,96,26,"finish"],[97,24,96,20],[97,25,96,33,"RemoteNotificationResult"],[97,66,96,58,"NewData"],[97,73,96,20],[98,0,97,20],[100,0,98,16],[100,15,98,21,"NotificationType"],[100,48,98,38,"NotificationResponse"],[100,68,98,16],[101,0,99,20,"notif"],[101,18,99,26,"finish"],[101,24,99,20],[102,0,100,20],[104,0,101,16],[104,15,101,21,"NotificationType"],[104,48,101,38,"WillPresent"],[104,59,101,16],[105,0,102,20,"notif"],[105,18,102,26,"finish"],[105,24,102,20],[105,25,102,33,"WillPresentNotificationResult"],[105,71,102,63,"All"],[105,74,102,20],[106,0,105,20],[107,0,94,12],[108,0,107,9],[109,0,108,5],[109,5,54,4],[111,0,110,4,"FCM"],[111,28,110,8,"on"],[111,30,110,4],[111,31,110,11,"FCMEvent"],[111,56,110,20,"RefreshToken"],[111,68,110,4],[111,70,110,34],[111,87,110,43],[112,0,111,8,"console"],[112,14,111,16,"log"],[112,17,111,8],[112,18,111,20],[112,46,111,8],[112,48,111,50,"token"],[112,53,111,8],[113,0,112,5],[113,5,110,4],[115,0,114,4,"FCM"],[115,28,114,8,"enableDirectChannel"],[115,47,114,4],[117,0,115,4,"FCM"],[117,28,115,8,"on"],[117,30,115,4],[117,31,115,11,"FCMEvent"],[117,56,115,20,"DirectChannelConnectionChanged"],[117,86,115,4],[117,88,115,52],[117,98,115,53,"data"],[117,102,115,52],[117,104,115,62],[118,0,116,8,"console"],[118,14,116,16,"log"],[118,17,116,8],[118,18,116,20],[118,47,116,49,"data"],[118,51,116,8],[119,0,117,5],[119,5,115,4],[121,0,118,4,"setTimeout"],[121,15,118,15],[121,27,118,27],[122,0,119,8,"FCM"],[122,30,119,12,"isDirectChannelEstablished"],[122,56,119,8],[122,59,119,41,"then"],[122,63,119,8],[122,64,119,46],[123,0,119,46],[123,15,119,51,"console"],[123,23,119,59,"log"],[123,26,119,51],[123,27,119,63,"d"],[123,28,119,51],[123,29,119,46],[124,0,119,46],[124,7,119,8],[125,0,120,5],[125,5,118,4],[125,7,120,7],[125,11,118,4],[126,0,121,1],[128,0,123,0,"FCM"],[128,26,123,4,"setNotificationCategories"],[128,51,123,0],[128,52,123,30],[128,53,124,4],[129,0,125,8,"id"],[129,8,125,12],[129,22,124,4],[130,0,126,8,"actions"],[130,13,126,17],[130,14,127,12],[131,0,128,16,"type"],[131,12,128,22,"NotificationActionType"],[131,51,128,45,"TextInput"],[131,60,127,12],[132,0,129,16,"id"],[132,10,129,20],[132,17,127,12],[133,0,130,16,"title"],[133,13,130,23],[133,26,127,12],[134,0,131,16,"textInputButtonTitle"],[134,28,131,38],[134,34,127,12],[135,0,132,16,"textInputPlaceholder"],[135,28,132,38],[135,43,127,12],[136,0,133,16,"intentIdentifiers"],[136,25,133,35],[136,27,127,12],[137,0,134,16,"options"],[137,15,134,25,"NotificationActionOption"],[137,56,134,50,"AuthenticationRequired"],[138,0,127,12],[138,5,126,17],[138,7,136,12],[139,0,137,16,"type"],[139,12,137,22,"NotificationActionType"],[139,51,137,45,"Default"],[139,58,136,12],[140,0,138,16,"id"],[140,10,138,20],[140,16,136,12],[141,0,139,16,"title"],[141,13,139,23],[141,26,136,12],[142,0,140,16,"intentIdentifiers"],[142,25,140,35],[142,27,136,12],[143,0,141,16,"options"],[143,15,141,25,"NotificationActionOption"],[143,56,141,50,"Foreground"],[144,0,136,12],[144,5,126,17],[144,7,143,12],[145,0,144,16,"type"],[145,12,144,22,"NotificationActionType"],[145,51,144,45,"Default"],[145,58,143,12],[146,0,145,16,"id"],[146,10,145,20],[146,19,143,12],[147,0,146,16,"title"],[147,13,146,23],[147,22,143,12],[148,0,147,16,"intentIdentifiers"],[148,25,147,35],[148,27,143,12],[149,0,148,16,"options"],[149,15,148,25,"NotificationActionOption"],[149,56,148,50,"Destructive"],[150,0,143,12],[150,5,126,17],[150,6,124,4],[151,0,151,8,"options"],[151,13,151,17],[151,14,151,18,"NotificationCategoryOption"],[151,57,151,45,"CustomDismissAction"],[151,76,151,17],[151,78,151,66,"NotificationCategoryOption"],[151,121,151,93,"PreviewsShowTitle"],[151,138,151,17],[152,0,124,4],[152,3,123,30],[152,4,123,0]]},"type":"js/module"}]}