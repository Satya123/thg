{"dependencies":[{"name":"react-native","isAsync":false},{"name":"react-native-router-flux","isAsync":false},{"name":"react-native-fcm","isAsync":false},{"name":"./UserData","isAsync":false}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.registerKilledListener = registerKilledListener;\n  exports.registerAppListener = registerAppListener;\n\n  var _reactNative = _$$_REQUIRE(_dependencyMap[0], \"react-native\");\n\n  var _reactNativeRouterFlux = _$$_REQUIRE(_dependencyMap[1], \"react-native-router-flux\");\n\n  var _reactNativeFcm = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[2], \"react-native-fcm\"));\n\n  var _UserData = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./UserData\"));\n\n  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\n  _reactNative.AsyncStorage.getItem('lastNotification').then(function (data) {\n    if (data) {\n      _reactNative.AsyncStorage.removeItem('lastNotification');\n    }\n  });\n\n  _reactNative.AsyncStorage.getItem('lastMessage').then(function (data) {\n    if (data) {\n      _reactNative.AsyncStorage.removeItem('lastMessage');\n    }\n  });\n\n  function registerKilledListener() {\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.Notification, function (notif) {\n      _reactNative.AsyncStorage.setItem('lastNotification', JSON.stringify(notif));\n\n      if (notif.opened_from_tray) {\n        setTimeout(function () {\n          if (notif._actionIdentifier === 'reply') {\n            if (_reactNative.AppState.currentState !== 'background') {\n              alert('User replied ' + JSON.stringify(notif._userText));\n            } else {\n              _reactNative.AsyncStorage.setItem('lastMessage', JSON.stringify(notif._userText));\n            }\n          }\n\n          if (notif._actionIdentifier === 'view') {\n            alert(\"User clicked View in App\");\n          }\n\n          if (notif._actionIdentifier === 'dismiss') {\n            alert(\"User clicked Dismiss\");\n          }\n        }, 1000);\n      }\n    });\n  }\n\n  function registerAppListener(navigation) {\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.Notification, function (notif) {\n      if (_reactNative.Platform.OS === 'ios' && notif._notificationType === _reactNativeFcm.NotificationType.WillPresent && !notif.local_notification) {\n        notif.finish(_reactNativeFcm.WillPresentNotificationResult.All);\n        return;\n      }\n\n      if (notif.opened_from_tray) {\n        if (notif.targetScreen === 'detail') {\n          setTimeout(function () {\n            navigation.navigate('Detail');\n          }, 500);\n        }\n\n        setTimeout(function () {\n          _UserData.default.retriveData('token').then(function (res) {\n            if (res === '') {\n              _reactNativeRouterFlux.Actions.Login();\n            } else {\n              _reactNativeRouterFlux.Actions.Notification();\n            }\n          }, function (err) {});\n        }, 100);\n      }\n\n      if (_reactNative.Platform.OS === 'ios') {\n        switch (notif._notificationType) {\n          case _reactNativeFcm.NotificationType.Remote:\n            notif.finish(_reactNativeFcm.RemoteNotificationResult.NewData);\n            break;\n\n          case _reactNativeFcm.NotificationType.NotificationResponse:\n            notif.finish();\n            break;\n\n          case _reactNativeFcm.NotificationType.WillPresent:\n            notif.finish(_reactNativeFcm.WillPresentNotificationResult.All);\n            break;\n        }\n      }\n    });\n\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.RefreshToken, function (token) {});\n\n    _reactNativeFcm.default.enableDirectChannel();\n\n    _reactNativeFcm.default.on(_reactNativeFcm.FCMEvent.DirectChannelConnectionChanged, function (data) {});\n\n    setTimeout(function () {\n      _reactNativeFcm.default.isDirectChannelEstablished().then(function (d) {\n        return console.log(d);\n      });\n    }, 1000);\n  }\n\n  _reactNativeFcm.default.setNotificationCategories([{\n    id: 'com.thg.test',\n    actions: [{\n      type: _reactNativeFcm.NotificationActionType.TextInput,\n      id: 'reply',\n      title: 'Quick Reply',\n      textInputButtonTitle: 'Send',\n      textInputPlaceholder: 'Say something',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.AuthenticationRequired\n    }, {\n      type: _reactNativeFcm.NotificationActionType.Default,\n      id: 'view',\n      title: 'View in App',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.Foreground\n    }, {\n      type: _reactNativeFcm.NotificationActionType.Default,\n      id: 'dismiss',\n      title: 'Dismiss',\n      intentIdentifiers: [],\n      options: _reactNativeFcm.NotificationActionOption.Destructive\n    }],\n    options: [_reactNativeFcm.NotificationCategoryOption.CustomDismissAction, _reactNativeFcm.NotificationCategoryOption.PreviewsShowTitle]\n  }]);\n});","map":[[8,0,5,0],[10,0,6,0],[12,0,7,0],[14,0,8,0],[20,0,11,0,"AsyncStorage"],[20,28,11,13,"getItem"],[20,35,11,0],[20,36,11,21],[20,54,11,0],[20,56,11,41,"then"],[20,60,11,0],[20,61,11,46],[20,77,11,54],[21,0,12,4],[21,8,12,8,"data"],[21,12,12,4],[21,14,12,14],[22,0,15,8,"AsyncStorage"],[22,32,15,21,"removeItem"],[22,42,15,8],[22,43,15,32],[22,61,15,8],[23,0,16,5],[24,0,17,1],[24,3,11,0],[26,0,19,0,"AsyncStorage"],[26,28,19,13,"getItem"],[26,35,19,0],[26,36,19,21],[26,49,19,0],[26,51,19,36,"then"],[26,55,19,0],[26,56,19,41],[26,72,19,49],[27,0,20,4],[27,8,20,8,"data"],[27,12,20,4],[27,14,20,14],[28,0,23,8,"AsyncStorage"],[28,32,23,21,"removeItem"],[28,42,23,8],[28,43,23,32],[28,56,23,8],[29,0,24,5],[30,0,25,1],[30,3,19,0],[32,0,27,7],[32,11,27,16,"registerKilledListener"],[32,33,27,7],[32,36,27,41],[33,0,29,4,"FCM"],[33,28,29,8,"on"],[33,30,29,4],[33,31,29,11,"FCMEvent"],[33,56,29,20,"Notification"],[33,68,29,4],[33,70,29,34],[33,87,29,43],[34,0,30,8,"AsyncStorage"],[34,32,30,21,"setItem"],[34,39,30,8],[34,40,30,29],[34,58,30,8],[34,60,30,49,"JSON"],[34,65,30,54,"stringify"],[34,74,30,49],[34,75,30,64,"notif"],[34,80,30,49],[34,81,30,8],[36,0,31,8],[36,10,31,12,"notif"],[36,16,31,18,"opened_from_tray"],[36,32,31,8],[36,34,31,36],[37,0,32,12,"setTimeout"],[37,19,32,23],[37,31,32,29],[38,0,33,16],[38,14,33,20,"notif"],[38,20,33,26,"_actionIdentifier"],[38,37,33,20],[38,42,33,48],[38,49,33,16],[38,51,33,57],[39,0,34,20],[39,16,34,24,"AppState"],[39,38,34,33,"currentState"],[39,50,34,24],[39,55,34,50],[39,67,34,20],[39,69,34,64],[40,0,36,24,"alert"],[40,20,36,30],[40,38,36,48,"JSON"],[40,43,36,53,"stringify"],[40,52,36,48],[40,53,36,63,"notif"],[40,59,36,69,"_userText"],[40,68,36,48],[40,69,36,24],[41,0,37,21],[41,13,34,20],[41,19,37,27],[42,0,38,24,"AsyncStorage"],[42,40,38,37,"setItem"],[42,47,38,24],[42,48,38,45],[42,61,38,24],[42,63,38,60,"JSON"],[42,68,38,65,"stringify"],[42,77,38,60],[42,78,38,75,"notif"],[42,84,38,81,"_userText"],[42,93,38,60],[42,94,38,24],[43,0,39,21],[44,0,40,17],[46,0,41,16],[46,14,41,20,"notif"],[46,20,41,26,"_actionIdentifier"],[46,37,41,20],[46,42,41,48],[46,48,41,16],[46,50,41,56],[47,0,42,20,"alert"],[47,18,42,26],[47,44,42,20],[48,0,43,17],[50,0,44,16],[50,14,44,20,"notif"],[50,20,44,26,"_actionIdentifier"],[50,37,44,20],[50,42,44,48],[50,51,44,16],[50,53,44,59],[51,0,45,20,"alert"],[51,18,45,26],[51,40,45,20],[52,0,46,17],[53,0,47,13],[53,9,32,12],[53,11,47,15],[53,15,32,12],[54,0,48,9],[55,0,49,5],[55,5,29,4],[56,0,50,1],[58,0,53,7],[58,11,53,16,"registerAppListener"],[58,30,53,7],[58,31,53,36,"navigation"],[58,41,53,7],[58,43,53,48],[59,0,54,4,"FCM"],[59,28,54,8,"on"],[59,30,54,4],[59,31,54,11,"FCMEvent"],[59,56,54,20,"Notification"],[59,68,54,4],[59,70,54,34],[59,87,54,43],[60,0,57,8],[60,10,57,12,"Platform"],[60,32,57,21,"OS"],[60,34,57,12],[60,39,57,28],[60,44,57,12],[60,48,57,37,"notif"],[60,54,57,43,"_notificationType"],[60,71,57,37],[60,76,57,65,"NotificationType"],[60,109,57,82,"WillPresent"],[60,120,57,12],[60,124,57,97],[60,125,57,98,"notif"],[60,131,57,104,"local_notification"],[60,149,57,8],[60,151,57,124],[61,0,60,12,"notif"],[61,14,60,18,"finish"],[61,20,60,12],[61,21,60,25,"WillPresentNotificationResult"],[61,67,60,55,"All"],[61,70,60,12],[62,0,61,12],[63,0,62,9],[65,0,64,8],[65,10,64,12,"notif"],[65,16,64,18,"opened_from_tray"],[65,32,64,8],[65,34,64,36],[66,0,65,12],[66,12,65,16,"notif"],[66,18,65,22,"targetScreen"],[66,30,65,16],[66,35,65,39],[66,43,65,12],[66,45,65,49],[67,0,66,16,"setTimeout"],[67,21,66,27],[67,33,66,33],[68,0,67,20,"navigation"],[68,23,67,31,"navigate"],[68,31,67,20],[68,32,67,40],[68,40,67,20],[69,0,68,17],[69,11,66,16],[69,13,68,19],[69,16,66,16],[70,0,69,13],[72,0,70,12,"setTimeout"],[72,19,70,23],[72,31,70,29],[73,0,73,16,"UserData"],[73,28,73,25,"retriveData"],[73,39,73,16],[73,40,73,37],[73,47,73,16],[73,49,73,46,"then"],[73,53,73,16],[73,54,73,51],[73,64,73,52,"res"],[73,67,73,51],[73,69,73,60],[74,0,75,20],[74,16,75,24,"res"],[74,24,75,32],[74,26,75,20],[74,28,75,36],[75,0,76,24,"Actions"],[75,45,76,32,"Login"],[75,50,76,24],[76,0,77,21],[76,13,75,20],[76,19,77,27],[77,0,79,24,"Actions"],[77,45,79,32,"Notification"],[77,57,79,24],[78,0,81,21],[79,0,82,17],[79,11,73,16],[79,13,82,19],[79,23,82,20,"err"],[79,26,82,19],[79,28,82,28],[79,29,84,17],[79,30,73,16],[80,0,86,13],[80,9,70,12],[80,11,86,15],[80,14,70,12],[81,0,87,9],[83,0,89,8],[83,10,89,12,"Platform"],[83,32,89,21,"OS"],[83,34,89,12],[83,39,89,28],[83,44,89,8],[83,46,89,35],[84,0,94,12],[84,16,94,20,"notif"],[84,22,94,26,"_notificationType"],[84,39,94,12],[85,0,95,16],[85,15,95,21,"NotificationType"],[85,48,95,38,"Remote"],[85,54,95,16],[86,0,96,20,"notif"],[86,18,96,26,"finish"],[86,24,96,20],[86,25,96,33,"RemoteNotificationResult"],[86,66,96,58,"NewData"],[86,73,96,20],[87,0,97,20],[89,0,98,16],[89,15,98,21,"NotificationType"],[89,48,98,38,"NotificationResponse"],[89,68,98,16],[90,0,99,20,"notif"],[90,18,99,26,"finish"],[90,24,99,20],[91,0,100,20],[93,0,101,16],[93,15,101,21,"NotificationType"],[93,48,101,38,"WillPresent"],[93,59,101,16],[94,0,102,20,"notif"],[94,18,102,26,"finish"],[94,24,102,20],[94,25,102,33,"WillPresentNotificationResult"],[94,71,102,63,"All"],[94,74,102,20],[95,0,105,20],[96,0,94,12],[97,0,107,9],[98,0,108,5],[98,5,54,4],[100,0,110,4,"FCM"],[100,28,110,8,"on"],[100,30,110,4],[100,31,110,11,"FCMEvent"],[100,56,110,20,"RefreshToken"],[100,68,110,4],[100,70,110,34],[100,87,110,43],[100,88,112,5],[100,89,110,4],[102,0,114,4,"FCM"],[102,28,114,8,"enableDirectChannel"],[102,47,114,4],[104,0,115,4,"FCM"],[104,28,115,8,"on"],[104,30,115,4],[104,31,115,11,"FCMEvent"],[104,56,115,20,"DirectChannelConnectionChanged"],[104,86,115,4],[104,88,115,52],[104,98,115,53,"data"],[104,102,115,52],[104,104,115,62],[104,105,117,5],[104,106,115,4],[106,0,118,4,"setTimeout"],[106,15,118,15],[106,27,118,27],[107,0,119,8,"FCM"],[107,30,119,12,"isDirectChannelEstablished"],[107,56,119,8],[107,59,119,41,"then"],[107,63,119,8],[107,64,119,46],[108,0,119,46],[108,15,119,51,"console"],[108,23,119,59,"log"],[108,26,119,51],[108,27,119,63,"d"],[108,28,119,51],[108,29,119,46],[109,0,119,46],[109,7,119,8],[110,0,120,5],[110,5,118,4],[110,7,120,7],[110,11,118,4],[111,0,121,1],[113,0,123,0,"FCM"],[113,26,123,4,"setNotificationCategories"],[113,51,123,0],[113,52,123,30],[113,53,124,4],[114,0,125,8,"id"],[114,8,125,12],[114,22,124,4],[115,0,126,8,"actions"],[115,13,126,17],[115,14,127,12],[116,0,128,16,"type"],[116,12,128,22,"NotificationActionType"],[116,51,128,45,"TextInput"],[116,60,127,12],[117,0,129,16,"id"],[117,10,129,20],[117,17,127,12],[118,0,130,16,"title"],[118,13,130,23],[118,26,127,12],[119,0,131,16,"textInputButtonTitle"],[119,28,131,38],[119,34,127,12],[120,0,132,16,"textInputPlaceholder"],[120,28,132,38],[120,43,127,12],[121,0,133,16,"intentIdentifiers"],[121,25,133,35],[121,27,127,12],[122,0,134,16,"options"],[122,15,134,25,"NotificationActionOption"],[122,56,134,50,"AuthenticationRequired"],[123,0,127,12],[123,5,126,17],[123,7,136,12],[124,0,137,16,"type"],[124,12,137,22,"NotificationActionType"],[124,51,137,45,"Default"],[124,58,136,12],[125,0,138,16,"id"],[125,10,138,20],[125,16,136,12],[126,0,139,16,"title"],[126,13,139,23],[126,26,136,12],[127,0,140,16,"intentIdentifiers"],[127,25,140,35],[127,27,136,12],[128,0,141,16,"options"],[128,15,141,25,"NotificationActionOption"],[128,56,141,50,"Foreground"],[129,0,136,12],[129,5,126,17],[129,7,143,12],[130,0,144,16,"type"],[130,12,144,22,"NotificationActionType"],[130,51,144,45,"Default"],[130,58,143,12],[131,0,145,16,"id"],[131,10,145,20],[131,19,143,12],[132,0,146,16,"title"],[132,13,146,23],[132,22,143,12],[133,0,147,16,"intentIdentifiers"],[133,25,147,35],[133,27,143,12],[134,0,148,16,"options"],[134,15,148,25,"NotificationActionOption"],[134,56,148,50,"Destructive"],[135,0,143,12],[135,5,126,17],[135,6,124,4],[136,0,151,8,"options"],[136,13,151,17],[136,14,151,18,"NotificationCategoryOption"],[136,57,151,45,"CustomDismissAction"],[136,76,151,17],[136,78,151,66,"NotificationCategoryOption"],[136,121,151,93,"PreviewsShowTitle"],[136,138,151,17],[137,0,124,4],[137,3,123,30],[137,4,123,0]]},"type":"js/module"}]}